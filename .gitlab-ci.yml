stages:
  - module-pipelines

variables:
  VERSION: 1.0.${CI_PIPELINE_ID}
  
frontend:
  stage: module-pipelines
  trigger:
    include:
      - 'frontend/.gitlab-ci-frontend.yml'
    strategy: depend # depend нужен, если какой-нибудь дочерний пайплайн свалился, мы знали, что общий пайплайн тоже идёт с ошибкой
  only:
    changes: # как только происходит изменение в папке frontend, запускается дочерний пайплайн, который лежит в этой папке
      - frontend/**/*

backend:
  stage: module-pipelines
  trigger:
    include:
      - 'backend/.gitlab-ci-backend.yml'
    strategy: depend
  only:
    changes:  # как только происходит изменение в папке backend, запускается дочерний пайплайн, который лежит в этой папке
      - backend/**/*

kubernetes:
  stage: module-pipelines
  trigger:
    include:
      - 'kubernetes/.gitlab-ci-kubernetes.yml'
    strategy: depend
  only:
    changes:  # как только происходит изменение в папке kubernetes, запускается дочерний пайплайн, который лежит в этой папке
      - kubernetes/**/*

